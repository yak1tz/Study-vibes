# -*- coding: utf-8 -*-
"""proyecto.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/13k6l60KlxHvXC9znyROFmh1pi-Gc7F-m
"""

# ------------------------------------------------------------
# en esta parte importo todas las librer√≠as necesarias
# ------------------------------------------------------------
import streamlit as st       # streamlit permite crear la p√°gina web interactiva
import pandas as pd          # pandas me sirve para manejar la base de datos en excel
import matplotlib.pyplot as plt   # matplotlib me permite crear gr√°ficos dentro de streamlit


# ------------------------------------------------------------
# aqu√≠ cargo mi base de datos desde excel
# es importante que el archivo est√© en la misma carpeta del proyecto
# y se llame exactamente igual: base_datos_completa_focus.xlsx
# ------------------------------------------------------------
df = pd.read_excel("base_datos_completa_focus.xlsx")

# ------------------------------------------------------------
# creo un men√∫ lateral usando streamlit.sidebar
# este men√∫ permite moverse entre dos p√°ginas:
# - presentaci√≥n
# - encuesta
# ------------------------------------------------------------

menu = st.sidebar.selectbox("Selecciona una p√°gina", ["Presentaci√≥n", "Encuesta"])

# ============================================================
#                           P√ÅGINA 1
#                     PRESENTACI√ìN DEL PROYECTO
# ============================================================
if menu == "Presentaci√≥n":

    # t√≠tulo principal centrado
    st.markdown(
        "<h1 style='text-align: center;'>üéß Study Vibes: M√∫sica Para Concentrarte</h1>",
        unsafe_allow_html=True
    )

    # imagen del proyecto
    st.image("musica_estudio.png", use_container_width=True)

    # subt√≠tulo
    st.markdown(
        "<h3 style='text-align: center;'>Una Herramienta Interactiva Para Elegir La Playlist Perfecta Seg√∫n Tu Estado Emocional</h3>",
        unsafe_allow_html=True
    )

    st.write("")  # espacio est√©tico

    # ----------------------------------------------------------
    #                PRESENTACI√ìN DEL PROYECTO
    # ----------------------------------------------------------
    st.markdown(
        "<h2 style='text-align: center;'>Presentaci√≥n Del Proyecto</h2>",
        unsafe_allow_html=True
    )

    texto_presentacion = """
Hola, soy Yaki. Este proyecto nace de la idea de que la m√∫sica puede influir directamente en el nivel de 
concentraci√≥n de una persona. Muchas veces, cuando estudiamos, estamos cansados, estresados, con sue√±o, 
motivados o incluso ansiosos. A partir de esas emociones, busco m√∫sica que nos acompa√±e o nos ayude 
a enfocarnos mejor.

**Study Vibes** es una aplicaci√≥n que recomienda playlists seg√∫n dos factores principales:

1. **La emoci√≥n actual del usuario**  
2. **La actividad o materia que va a estudiar**

Esta plataforma funciona como una gu√≠a r√°pida para encontrar m√∫sica adecuada al momento emocional en el que te encuentras. Adem√°s, combina datos reales provenientes de un conjunto de playlists de Spotify y YouTube.
"""
    st.markdown(
        f"<div style='text-align: justify; font-size: 18px;'>{texto_presentacion}</div>",
        unsafe_allow_html=True
    )

    # ----------------------------------------------------------
    #                POR QU√â ELEG√ç ESTE TEMA
    # ----------------------------------------------------------
    st.markdown(
        "<h2 style='text-align: center;'>¬øPor Qu√© Eleg√≠ Este Tema?</h2>",
        unsafe_allow_html=True
    )

    texto_motivo = """
Eleg√≠ este tema porque la m√∫sica forma parte de la vida cotidiana de cualquier estudiante.
Muchos de nosotros no podemos estudiar en silencio absoluto, pero tampoco con cualquier g√©nero musical.  
La idea de este proyecto es simplificar esa b√∫squeda y hacerla m√°s personalizada y emocional.
"""
    st.markdown(
        f"<div style='text-align: justify; font-size: 18px;'>{texto_motivo}</div>",
        unsafe_allow_html=True
    )

    # ----------------------------------------------------------
    #                 ESTUDIOS QUE RESPALDAN
    # ----------------------------------------------------------
    st.markdown(
        "<h2 style='text-align: center;'>Estudios Que Respaldan El Proyecto</h2>",
        unsafe_allow_html=True
    )

    texto_estudios = """
Diversos estudios han demostrado que ciertos tipos de m√∫sica, especialmente el lo-fi, el ambient o el piano suave, 
pueden mejorar el enfoque, la memoria de trabajo y la retenci√≥n de informaci√≥n.  

Investigaciones en neurociencia indican que la m√∫sica afecta directamente el sistema l√≠mbico, el √°rea del cerebro 
relacionada con las emociones, lo cual influye en nuestro estado mental al estudiar.

Por eso, Study Vibes usa **emociones + actividad acad√©mica** para recomendar playlists alineadas a lo que realmente 
necesitas en ese momento.
"""
    st.markdown(
        f"<div style='text-align: justify; font-size: 18px;'>{texto_estudios}</div>",
        unsafe_allow_html=True
    )

    # ----------------------------------------------------------
    #                    GR√ÅFICO DE DATOS
    # ----------------------------------------------------------
    st.header("Cantidad de playlists por emoci√≥n")

    # conteo
    conteo = df["emocion"].value_counts()

    # crear gr√°fico
    fig, ax = plt.subplots()
    ax.bar(conteo.index, conteo.values)
    ax.set_xlabel("emociones")
    ax.set_ylabel("cantidad")
    ax.set_title("playlists seg√∫n emoci√≥n")
    plt.xticks(rotation=45)

    # mostrar gr√°fico
    st.pyplot(fig)
# ============================================================
#                           P√ÅGINA 2
#                     ENCUESTA INTERACTIVA
# ============================================================
elif menu == "Encuesta":

    st.title("Encuesta interactiva üéµ")

    # SELECTBOX EMOCI√ìN
    emocion_usuario = st.selectbox(
        "¬øc√≥mo te sientes?",
        df["emocion"].unique()
    )

    # SELECTBOX MATERIA
    actividad_usuario = st.selectbox(
        "¬øqu√© vas a estudiar o hacer?",
        df["materia"].unique()
    )

    # SELECTBOX DURACI√ìN
    duracion_usuario = st.selectbox(
        "¬øqu√© duraci√≥n prefieres?",
        df["tipo"].unique()
    )

    # normalizar
    df["emocion"] = df["emocion"].str.lower().str.strip()
    df["materia"] = df["materia"].str.lower().str.strip()
    df["tipo"] = df["tipo"].str.lower().str.strip()

    emocion_usuario = emocion_usuario.lower().strip()
    actividad_usuario = actividad_usuario.lower().strip()
    duracion_usuario = duracion_usuario.lower().strip()

    # filtrado
    resultado = df[
        (df["emocion"] == emocion_usuario) &
        (df["materia"] == actividad_usuario) &
        (df["tipo"] == duracion_usuario)
    ]

    if resultado.empty:
        resultado = df[df["emocion"] == emocion_usuario]

    if resultado.empty:
        resultado = df[df["materia"] == actividad_usuario]

    if resultado.empty:
        resultado = df[df["tipo"] == duracion_usuario]

    if resultado.empty:
        resultado = df.sample(1)

    row = resultado.sample(1).iloc[0]

    st.subheader("üéß playlist recomendada:")
    st.write("**emocion:**", row["emocion"])
    st.write("**materia:**", row["materia"])
    st.write("**playlist:**", row["playlist"])
    st.write("**duraci√≥n:**", str(row["duracion"]) + " minutos")
    st.write("**tipo:**", row["tipo"])
    st.write("**a√±o:**", int(row["a√±o"]))
    st.write("**enlace:**", row["link"])